{
  "//": {
    "metadata": {
      "backend": "local",
      "stackName": "layerx-eks-stack",
      "version": "0.21.0"
    },
    "outputs": {
      "layerx-eks-stack": {
        "cluster_ca_certificate": "cluster_ca_certificate",
        "cluster_endpoint": "cluster_endpoint",
        "cluster_name": "cluster_name",
        "kubeconfig_command": "kubeconfig_command",
        "monitoring-event-exporter-role-arn": "monitoring-event-exporter-role-arn"
      }
    }
  },
  "data": {
    "aws_availability_zones": {
      "vpc_available_59531BA6": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/available",
            "uniqueId": "vpc_available_59531BA6"
          }
        },
        "state": "available"
      }
    },
    "aws_caller_identity": {
      "app-iam-caller-identity": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/app-iam-caller-identity",
            "uniqueId": "app-iam-caller-identity"
          }
        }
      },
      "current-identity": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/current-identity",
            "uniqueId": "current-identity"
          }
        }
      }
    },
    "aws_eks_cluster_auth": {
      "eks-auth": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/eks-auth",
            "uniqueId": "eks-auth"
          }
        },
        "name": "${aws_eks_cluster.eksCluster.name}"
      }
    },
    "aws_iam_policy_document": {
      "ebsCsiDriverTrustPolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/ebsCsiDriverTrustPolicy",
            "uniqueId": "ebsCsiDriverTrustPolicy"
          }
        },
        "statement": [
          {
            "actions": [
              "sts:AssumeRoleWithWebIdentity"
            ],
            "condition": [
              {
                "test": "StringEquals",
                "values": [
                  "system:serviceaccount:kube-system:ebs-csi-controller-sa"
                ],
                "variable": "${join(\"\", [replace(aws_eks_cluster.eksCluster.identity[0].oidc[0].issuer, \"https://\", \"\"), \":sub\"])}"
              }
            ],
            "effect": "Allow",
            "principals": [
              {
                "identifiers": [
                  "${join(\"\", [\"arn:aws:iam::\", data.aws_caller_identity.current-identity.account_id, \":oidc-provider/\", replace(aws_eks_cluster.eksCluster.identity[0].oidc[0].issuer, \"https://\", \"\")])}"
                ],
                "type": "Federated"
              }
            ]
          }
        ]
      },
      "lbControllerTrustPolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/lbControllerTrustPolicy",
            "uniqueId": "lbControllerTrustPolicy"
          }
        },
        "statement": [
          {
            "actions": [
              "sts:AssumeRoleWithWebIdentity"
            ],
            "condition": [
              {
                "test": "StringEquals",
                "values": [
                  "system:serviceaccount:kube-system:aws-load-balancer-controller"
                ],
                "variable": "${join(\"\", [replace(aws_eks_cluster.eksCluster.identity[0].oidc[0].issuer, \"https://\", \"\"), \":sub\"])}"
              }
            ],
            "effect": "Allow",
            "principals": [
              {
                "identifiers": [
                  "${join(\"\", [\"arn:aws:iam::\", data.aws_caller_identity.current-identity.account_id, \":oidc-provider/\", replace(aws_eks_cluster.eksCluster.identity[0].oidc[0].issuer, \"https://\", \"\")])}"
                ],
                "type": "Federated"
              }
            ]
          }
        ]
      }
    },
    "aws_region": {
      "current-region": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/current-region",
            "uniqueId": "current-region"
          }
        }
      },
      "vpc_current_561DBC69": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/current",
            "uniqueId": "vpc_current_561DBC69"
          }
        }
      }
    }
  },
  "output": {
    "cluster_ca_certificate": {
      "description": "The certificate authority data for the cluster (base64 encoded)",
      "sensitive": true,
      "value": "${aws_eks_cluster.eksCluster.certificate_authority[0].data}"
    },
    "cluster_endpoint": {
      "description": "The endpoint for the EKS cluster API server",
      "value": "${aws_eks_cluster.eksCluster.endpoint}"
    },
    "cluster_name": {
      "description": "The name of the EKS cluster",
      "value": "${aws_eks_cluster.eksCluster.name}"
    },
    "kubeconfig_command": {
      "description": "Command to configure kubectl for the cluster",
      "value": "${join(\"\", [\"aws eks update-kubeconfig --name \", aws_eks_cluster.eksCluster.name, \" --region $(aws configure get region)\"])}"
    },
    "monitoring-event-exporter-role-arn": {
      "description": "${join(\"\", [\"ARN of the IAM role for \", \"event-exporter\", \" in namespace \", \"monitoring\"])}",
      "value": "${aws_iam_role.app-iam-monitoring-event-exporter_role_BB157BD4.arn}"
    }
  },
  "provider": {
    "aws": [
      {
        "region": "eu-central-1"
      }
    ],
    "helm": [
      {
        "kubernetes": {
          "cluster_ca_certificate": "${base64decode(aws_eks_cluster.eksCluster.certificate_authority[0].data)}",
          "host": "${aws_eks_cluster.eksCluster.endpoint}",
          "token": "${data.aws_eks_cluster_auth.eks-auth.token}"
        }
      }
    ],
    "kubernetes": [
      {
        "cluster_ca_certificate": "${base64decode(aws_eks_cluster.eksCluster.certificate_authority[0].data)}",
        "host": "${aws_eks_cluster.eksCluster.endpoint}",
        "token": "${data.aws_eks_cluster_auth.eks-auth.token}"
      }
    ]
  },
  "resource": {
    "aws_eks_addon": {
      "aws-ebs-csi-driver": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/aws-ebs-csi-driver",
            "uniqueId": "aws-ebs-csi-driver"
          }
        },
        "addon_name": "aws-ebs-csi-driver",
        "addon_version": "v1.44.0-eksbuild.1",
        "cluster_name": "${aws_eks_cluster.eksCluster.name}",
        "resolve_conflicts_on_create": "OVERWRITE",
        "resolve_conflicts_on_update": "PRESERVE",
        "service_account_role_arn": "${aws_iam_role.ebsCsiDriverRole.arn}"
      }
    },
    "aws_eks_cluster": {
      "eksCluster": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/eksCluster",
            "uniqueId": "eksCluster"
          }
        },
        "access_config": {
          "authentication_mode": "API_AND_CONFIG_MAP",
          "bootstrap_cluster_creator_admin_permissions": true
        },
        "bootstrap_self_managed_addons": true,
        "compute_config": {
          "enabled": false
        },
        "depends_on": [
          "aws_vpc.vpc_6776A399",
          "aws_subnet.vpc_public-subnet-1_B6E44E35",
          "aws_subnet.vpc_public-subnet-2_50BC5771"
        ],
        "kubernetes_network_config": {
          "elastic_load_balancing": {
            "enabled": false
          },
          "ip_family": "ipv4",
          "service_ipv4_cidr": "10.100.0.0/16"
        },
        "name": "layerx-eks",
        "role_arn": "${aws_iam_role.eksRole.arn}",
        "storage_config": {
          "block_storage": {
            "enabled": false
          }
        },
        "version": "1.31",
        "vpc_config": {
          "endpoint_private_access": false,
          "endpoint_public_access": true,
          "public_access_cidrs": [
            "0.0.0.0/0"
          ],
          "subnet_ids": [
            "${aws_subnet.vpc_public-subnet-1_B6E44E35.id}",
            "${aws_subnet.vpc_public-subnet-2_50BC5771.id}"
          ]
        }
      }
    },
    "aws_eks_node_group": {
      "eksNodeGroup": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/eksNodeGroup",
            "uniqueId": "eksNodeGroup"
          }
        },
        "ami_type": "AL2_x86_64",
        "cluster_name": "${aws_eks_cluster.eksCluster.name}",
        "depends_on": [
          "aws_eks_cluster.eksCluster"
        ],
        "disk_size": 20,
        "instance_types": [
          "t3.small"
        ],
        "node_role_arn": "${aws_iam_role.nodeRole.arn}",
        "scaling_config": {
          "desired_size": 2,
          "max_size": 8,
          "min_size": 2
        },
        "subnet_ids": [
          "${aws_subnet.vpc_public-subnet-1_B6E44E35.id}",
          "${aws_subnet.vpc_public-subnet-2_50BC5771.id}"
        ],
        "tags": {
          "${join(\"\", [\"kubernetes.io/cluster/\", \"layerx-eks\"])}": "owned",
          "Name": "${join(\"-\", [\"layerx-eks\", \"node\"])}"
        },
        "version": "${aws_eks_cluster.eksCluster.version}"
      }
    },
    "aws_iam_openid_connect_provider": {
      "eks-oidc-provider": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/eks-oidc-provider",
            "uniqueId": "eks-oidc-provider"
          }
        },
        "client_id_list": [
          "sts.amazonaws.com"
        ],
        "tags": {
          "Name": "${join(\"-\", [\"layerx-eks\", \"oidc-provider\"])}"
        },
        "thumbprint_list": [
          "9e99a48a9960b14926bb7f3b02e22da2b0ab7280"
        ],
        "url": "${aws_eks_cluster.eksCluster.identity[0].oidc[0].issuer}"
      }
    },
    "aws_iam_policy": {
      "lbControllerPolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/lbControllerPolicy",
            "uniqueId": "lbControllerPolicy"
          }
        },
        "name": "${join(\"-\", [\"layerx-eks-lb-controller-role\", \"policy\"])}",
        "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"CreateELBServiceLinkedRole\",\"Effect\":\"Allow\",\"Action\":[\"iam:CreateServiceLinkedRole\"],\"Resource\":\"*\",\"Condition\":{\"StringEquals\":{\"iam:AWSServiceName\":\"elasticloadbalancing.amazonaws.com\"}}},{\"Sid\":\"ReadEC2andELBResources\",\"Effect\":\"Allow\",\"Action\":[\"ec2:DescribeAccountAttributes\",\"ec2:DescribeAddresses\",\"ec2:DescribeAvailabilityZones\",\"ec2:DescribeInternetGateways\",\"ec2:DescribeVpcs\",\"ec2:DescribeVpcPeeringConnections\",\"ec2:DescribeSubnets\",\"ec2:DescribeSecurityGroups\",\"ec2:DescribeInstances\",\"ec2:DescribeNetworkInterfaces\",\"ec2:DescribeTags\",\"ec2:GetCoipPoolUsage\",\"ec2:DescribeCoipPools\",\"elasticloadbalancing:DescribeLoadBalancers\",\"elasticloadbalancing:DescribeLoadBalancerAttributes\",\"elasticloadbalancing:DescribeListeners\",\"elasticloadbalancing:DescribeListenerCertificates\",\"elasticloadbalancing:DescribeSSLPolicies\",\"elasticloadbalancing:DescribeRules\",\"elasticloadbalancing:DescribeTargetGroups\",\"elasticloadbalancing:DescribeTargetGroupAttributes\",\"elasticloadbalancing:DescribeTargetHealth\",\"elasticloadbalancing:DescribeTags\"],\"Resource\":\"*\"},{\"Sid\":\"AccessRelatedAWSServices\",\"Effect\":\"Allow\",\"Action\":[\"cognito-idp:DescribeUserPoolClient\",\"acm:ListCertificates\",\"acm:DescribeCertificate\",\"iam:ListServerCertificates\",\"iam:GetServerCertificate\",\"waf-regional:GetWebACL\",\"waf-regional:GetWebACLForResource\",\"waf-regional:AssociateWebACL\",\"waf-regional:DisassociateWebACL\",\"wafv2:GetWebACL\",\"wafv2:GetWebACLForResource\",\"wafv2:AssociateWebACL\",\"wafv2:DisassociateWebACL\",\"shield:GetSubscriptionState\",\"shield:DescribeProtection\",\"shield:CreateProtection\",\"shield:DeleteProtection\"],\"Resource\":\"*\"},{\"Sid\":\"ManageSecurityGroupRules\",\"Effect\":\"Allow\",\"Action\":[\"ec2:AuthorizeSecurityGroupIngress\",\"ec2:RevokeSecurityGroupIngress\"],\"Resource\":\"*\"},{\"Sid\":\"CreateSecurityGroups\",\"Effect\":\"Allow\",\"Action\":[\"ec2:CreateSecurityGroup\"],\"Resource\":\"*\"},{\"Sid\":\"TagNewSecurityGroups\",\"Effect\":\"Allow\",\"Action\":[\"ec2:CreateTags\"],\"Resource\":\"arn:aws:ec2:*:*:security-group/*\",\"Condition\":{\"StringEquals\":{\"ec2:CreateAction\":\"CreateSecurityGroup\"},\"Null\":{\"aws:RequestTag/elbv2.k8s.aws/cluster\":\"false\"}}},{\"Sid\":\"ManageSecurityGroupTags\",\"Effect\":\"Allow\",\"Action\":[\"ec2:CreateTags\",\"ec2:DeleteTags\"],\"Resource\":\"arn:aws:ec2:*:*:security-group/*\",\"Condition\":{\"Null\":{\"aws:RequestTag/elbv2.k8s.aws/cluster\":\"true\",\"aws:ResourceTag/elbv2.k8s.aws/cluster\":\"false\"}}},{\"Sid\":\"ManageSecurityGroups\",\"Effect\":\"Allow\",\"Action\":[\"ec2:AuthorizeSecurityGroupIngress\",\"ec2:RevokeSecurityGroupIngress\",\"ec2:DeleteSecurityGroup\"],\"Resource\":\"*\",\"Condition\":{\"Null\":{\"aws:ResourceTag/elbv2.k8s.aws/cluster\":\"false\"}}},{\"Sid\":\"CreateLoadBalancersAndTargetGroups\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:CreateLoadBalancer\",\"elasticloadbalancing:CreateTargetGroup\"],\"Resource\":\"*\",\"Condition\":{\"Null\":{\"aws:RequestTag/elbv2.k8s.aws/cluster\":\"false\"}}},{\"Sid\":\"ManageELBListenersAndRules\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:CreateListener\",\"elasticloadbalancing:DeleteListener\",\"elasticloadbalancing:CreateRule\",\"elasticloadbalancing:DeleteRule\"],\"Resource\":\"*\"},{\"Sid\":\"ManageELBAndTargetGroupTags\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:AddTags\",\"elasticloadbalancing:RemoveTags\"],\"Resource\":[\"arn:aws:elasticloadbalancing:*:*:targetgroup/*/*\",\"arn:aws:elasticloadbalancing:*:*:loadbalancer/net/*/*\",\"arn:aws:elasticloadbalancing:*:*:loadbalancer/app/*/*\"],\"Condition\":{\"Null\":{\"aws:RequestTag/elbv2.k8s.aws/cluster\":\"true\",\"aws:ResourceTag/elbv2.k8s.aws/cluster\":\"false\"}}},{\"Sid\":\"ManageListenerAndRuleTags\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:AddTags\",\"elasticloadbalancing:RemoveTags\"],\"Resource\":[\"arn:aws:elasticloadbalancing:*:*:listener/net/*/*/*\",\"arn:aws:elasticloadbalancing:*:*:listener/app/*/*/*\",\"arn:aws:elasticloadbalancing:*:*:listener-rule/net/*/*/*\",\"arn:aws:elasticloadbalancing:*:*:listener-rule/app/*/*/*\"]},{\"Sid\":\"ManageELBAndTargetGroupSettings\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:ModifyLoadBalancerAttributes\",\"elasticloadbalancing:SetIpAddressType\",\"elasticloadbalancing:SetSecurityGroups\",\"elasticloadbalancing:SetSubnets\",\"elasticloadbalancing:DeleteLoadBalancer\",\"elasticloadbalancing:ModifyTargetGroup\",\"elasticloadbalancing:ModifyTargetGroupAttributes\",\"elasticloadbalancing:DeleteTargetGroup\"],\"Resource\":\"*\",\"Condition\":{\"Null\":{\"aws:ResourceTag/elbv2.k8s.aws/cluster\":\"false\"}}},{\"Sid\":\"ManageArgoCDResourceTags\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:AddTags\"],\"Resource\":[\"arn:aws:elasticloadbalancing:*:*:targetgroup/k8s-argocd-*/*\",\"arn:aws:elasticloadbalancing:*:*:loadbalancer/*/k8s-argocd-*/*\"]},{\"Sid\":\"ManageTargetGroupRegistrations\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:RegisterTargets\",\"elasticloadbalancing:DeregisterTargets\"],\"Resource\":\"arn:aws:elasticloadbalancing:*:*:targetgroup/*/*\"},{\"Sid\":\"ManageListenersAndRules\",\"Effect\":\"Allow\",\"Action\":[\"elasticloadbalancing:SetWebAcl\",\"elasticloadbalancing:ModifyListener\",\"elasticloadbalancing:AddListenerCertificates\",\"elasticloadbalancing:RemoveListenerCertificates\",\"elasticloadbalancing:ModifyRule\"],\"Resource\":\"*\"}]}"
      }
    },
    "aws_iam_role": {
      "app-iam-monitoring-event-exporter_role_BB157BD4": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/app-iam-monitoring-event-exporter/role",
            "uniqueId": "app-iam-monitoring-event-exporter_role_BB157BD4"
          }
        },
        "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"${join(\"\", [\"arn:aws:iam::\", data.aws_caller_identity.app-iam-caller-identity.account_id, \":oidc-provider/\", replace(aws_eks_cluster.eksCluster.identity[0].oidc[0].issuer, \"https://\", \"\")])}\"},\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"${replace(aws_eks_cluster.eksCluster.identity[0].oidc[0].issuer, \"https://\", \"\")}:sub\":\"system:serviceaccount:monitoring:event-exporter\"}}}]}",
        "description": "IAM role for event-exporter in the monitoring namespace",
        "name": "${join(\"-\", [replace(\"layerx-eks\", \"*\", \"wildcard\"), replace(\"monitoring\", \"*\", \"wildcard\"), replace(\"event-exporter\", \"*\", \"wildcard\"), replace(\"role\", \"*\", \"wildcard\")])}"
      },
      "ebsCsiDriverRole": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/ebsCsiDriverRole",
            "uniqueId": "ebsCsiDriverRole"
          }
        },
        "assume_role_policy": "${data.aws_iam_policy_document.ebsCsiDriverTrustPolicy.json}",
        "name": "layerx-eks-ebs-csi-driver-role"
      },
      "eksRole": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/eksRole",
            "uniqueId": "eksRole"
          }
        },
        "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"eks.amazonaws.com\"}}]}",
        "name": "layerx-eks-cluster-role"
      },
      "lbControllerRole": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/lbControllerRole",
            "uniqueId": "lbControllerRole"
          }
        },
        "assume_role_policy": "${data.aws_iam_policy_document.lbControllerTrustPolicy.json}",
        "name": "layerx-eks-lb-controller-role"
      },
      "nodeRole": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/nodeRole",
            "uniqueId": "nodeRole"
          }
        },
        "assume_role_policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ec2.amazonaws.com\"}}]}",
        "name": "layerx-eks-node-role"
      }
    },
    "aws_iam_role_policy": {
      "app-iam-monitoring-event-exporter_event-exporter-secrets-policy_289313DA": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/app-iam-monitoring-event-exporter/event-exporter-secrets-policy",
            "uniqueId": "app-iam-monitoring-event-exporter_event-exporter-secrets-policy_289313DA"
          }
        },
        "name": "${join(\"-\", [replace(\"layerx-eks\", \"*\", \"wildcard\"), replace(\"monitoring\", \"*\", \"wildcard\"), replace(\"event-exporter\", \"*\", \"wildcard\"), replace(\"secrets-access\", \"*\", \"wildcard\")])}",
        "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"secretsmanager:GetSecretValue\",\"secretsmanager:DescribeSecret\"],\"Resource\":[\"arn:aws:secretsmanager:eu-central-1:${data.aws_caller_identity.app-iam-caller-identity.account_id}:secret:home-assignments/layerx\"]}]}",
        "role": "${aws_iam_role.app-iam-monitoring-event-exporter_role_BB157BD4.id}"
      }
    },
    "aws_iam_role_policy_attachment": {
      "cniPolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/cniPolicy",
            "uniqueId": "cniPolicy"
          }
        },
        "policy_arn": "arn:aws:iam::aws:policy/AmazonEKS_CNI_Policy",
        "role": "${aws_iam_role.nodeRole.name}"
      },
      "ebsCsiDriverPolicyAttachment": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/ebsCsiDriverPolicyAttachment",
            "uniqueId": "ebsCsiDriverPolicyAttachment"
          }
        },
        "policy_arn": "arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy",
        "role": "${aws_iam_role.ebsCsiDriverRole.name}"
      },
      "eksServicePolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/eksServicePolicy",
            "uniqueId": "eksServicePolicy"
          }
        },
        "policy_arn": "arn:aws:iam::aws:policy/AmazonEKSClusterPolicy",
        "role": "${aws_iam_role.eksRole.name}"
      },
      "lbControllerPolicyAttachment": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/lbControllerPolicyAttachment",
            "uniqueId": "lbControllerPolicyAttachment"
          }
        },
        "policy_arn": "${aws_iam_policy.lbControllerPolicy.arn}",
        "role": "${aws_iam_role.lbControllerRole.name}"
      },
      "nodePolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/nodePolicy",
            "uniqueId": "nodePolicy"
          }
        },
        "policy_arn": "arn:aws:iam::aws:policy/AmazonEKSWorkerNodePolicy",
        "role": "${aws_iam_role.nodeRole.name}"
      },
      "registryPolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/registryPolicy",
            "uniqueId": "registryPolicy"
          }
        },
        "policy_arn": "arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryReadOnly",
        "role": "${aws_iam_role.nodeRole.name}"
      },
      "ssmPolicy": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/ssmPolicy",
            "uniqueId": "ssmPolicy"
          }
        },
        "policy_arn": "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore",
        "role": "${aws_iam_role.nodeRole.name}"
      }
    },
    "aws_internet_gateway": {
      "vpc_igw_E5E304CC": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/igw",
            "uniqueId": "vpc_igw_E5E304CC"
          }
        },
        "tags": {
          "Name": "${join(\"-\", [\"layerx-eks\", \"igw\"])}"
        },
        "vpc_id": "${aws_vpc.vpc_6776A399.id}"
      }
    },
    "aws_route": {
      "vpc_public-route_F447845C": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/public-route",
            "uniqueId": "vpc_public-route_F447845C"
          }
        },
        "destination_cidr_block": "0.0.0.0/0",
        "gateway_id": "${aws_internet_gateway.vpc_igw_E5E304CC.id}",
        "route_table_id": "${aws_route_table.vpc_public-rtb_E3600128.id}"
      }
    },
    "aws_route_table": {
      "vpc_public-rtb_E3600128": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/public-rtb",
            "uniqueId": "vpc_public-rtb_E3600128"
          }
        },
        "tags": {
          "Name": "${join(\"-\", [\"layerx-eks\", \"public-rtb\"])}"
        },
        "vpc_id": "${aws_vpc.vpc_6776A399.id}"
      }
    },
    "aws_route_table_association": {
      "vpc_public-rta-1_CA1395F4": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/public-rta-1",
            "uniqueId": "vpc_public-rta-1_CA1395F4"
          }
        },
        "route_table_id": "${aws_route_table.vpc_public-rtb_E3600128.id}",
        "subnet_id": "${aws_subnet.vpc_public-subnet-1_B6E44E35.id}"
      },
      "vpc_public-rta-2_F1EC92DC": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/public-rta-2",
            "uniqueId": "vpc_public-rta-2_F1EC92DC"
          }
        },
        "route_table_id": "${aws_route_table.vpc_public-rtb_E3600128.id}",
        "subnet_id": "${aws_subnet.vpc_public-subnet-2_50BC5771.id}"
      }
    },
    "aws_subnet": {
      "vpc_public-subnet-1_B6E44E35": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/public-subnet-1",
            "uniqueId": "vpc_public-subnet-1_B6E44E35"
          }
        },
        "availability_zone": "${join(\"\", [data.aws_region.vpc_current_561DBC69.name, \"a\"])}",
        "cidr_block": "10.0.0.0/20",
        "map_public_ip_on_launch": true,
        "tags": {
          "${join(\"\", [\"kubernetes.io/cluster/\", \"layerx-eks\"])}": "owned",
          "Name": "${join(\"-\", [\"layerx-eks\", \"public-subnet\", \"1\"])}",
          "kubernetes.io/role/elb": "1",
          "kubernetes.io/role/internal-elb": "1"
        },
        "vpc_id": "${aws_vpc.vpc_6776A399.id}"
      },
      "vpc_public-subnet-2_50BC5771": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/public-subnet-2",
            "uniqueId": "vpc_public-subnet-2_50BC5771"
          }
        },
        "availability_zone": "${join(\"\", [data.aws_region.vpc_current_561DBC69.name, \"b\"])}",
        "cidr_block": "10.0.16.0/20",
        "map_public_ip_on_launch": true,
        "tags": {
          "${join(\"\", [\"kubernetes.io/cluster/\", \"layerx-eks\"])}": "owned",
          "Name": "${join(\"-\", [\"layerx-eks\", \"public-subnet\", \"2\"])}",
          "kubernetes.io/role/elb": "1",
          "kubernetes.io/role/internal-elb": "1"
        },
        "vpc_id": "${aws_vpc.vpc_6776A399.id}"
      }
    },
    "aws_vpc": {
      "vpc_6776A399": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/vpc/vpc",
            "uniqueId": "vpc_6776A399"
          }
        },
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "tags": {
          "${join(\"\", [\"kubernetes.io/cluster/\", \"layerx-eks\"])}": "owned",
          "Name": "${join(\"-\", [\"layerx-eks\", \"vpc\"])}"
        }
      }
    },
    "helm_release": {
      "argocd": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/argocd",
            "uniqueId": "argocd"
          }
        },
        "atomic": false,
        "chart": "argo-cd",
        "cleanup_on_fail": false,
        "create_namespace": true,
        "depends_on": [
          "helm_release.aws-load-balancer-controller",
          "helm_release.external-secrets-operator"
        ],
        "name": "argocd",
        "namespace": "argocd",
        "provider": "helm",
        "recreate_pods": false,
        "repository": "https://argoproj.github.io/argo-helm",
        "timeout": 1200,
        "values": [
          "{\"global\":{\"securityContext\":{\"runAsNonRoot\":true,\"runAsUser\":999}},\"server\":{\"replicas\":1,\"extraArgs\":[\"--insecure\"],\"service\":{\"type\":\"LoadBalancer\",\"annotations\":{\"service.beta.kubernetes.io/aws-load-balancer-scheme\":\"internet-facing\"}},\"autoscaling\":{\"enabled\":false},\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"64Mi\"}}},\"controller\":{\"replicas\":1,\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"64Mi\"}}},\"repoServer\":{\"replicas\":1,\"resources\":{\"limits\":{\"cpu\":\"100m\",\"memory\":\"128Mi\"},\"requests\":{\"cpu\":\"50m\",\"memory\":\"64Mi\"}}},\"applicationSet\":{\"enabled\":false},\"notifications\":{\"enabled\":false},\"dex\":{\"enabled\":false},\"configs\":{\"secret\":{\"createSecret\":true,\"argocdServerAdminPassword\":\"$2a$12$QmPft0fN51eBUiDvWcEcQOSU73Eu/OSaIUvsHuop5JgnwB67CIiRi\"}}}"
        ],
        "version": "7.0.0",
        "wait": true
      },
      "aws-load-balancer-controller": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/aws-load-balancer-controller",
            "uniqueId": "aws-load-balancer-controller"
          }
        },
        "atomic": true,
        "chart": "aws-load-balancer-controller",
        "cleanup_on_fail": true,
        "create_namespace": false,
        "depends_on": [
          "aws_eks_cluster.eksCluster",
          "aws_eks_node_group.eksNodeGroup"
        ],
        "name": "aws-load-balancer-controller",
        "namespace": "kube-system",
        "provider": "helm",
        "recreate_pods": true,
        "replace": true,
        "repository": "https://aws.github.io/eks-charts",
        "skip_crds": false,
        "timeout": 900,
        "values": [
          "{\"clusterName\":\"${aws_eks_cluster.eksCluster.name}\",\"region\":\"${data.aws_region.current-region.name}\",\"vpcId\":\"${aws_vpc.vpc_6776A399.id}\",\"installCRDs\":true,\"ingressClass\":\"alb\",\"serviceAccount\":{\"create\":true,\"name\":\"aws-load-balancer-controller\",\"annotations\":{\"eks.amazonaws.com/role-arn\":\"${aws_iam_role.lbControllerRole.arn}\"}},\"enableShield\":false,\"enableWaf\":false,\"enableWafv2\":false,\"resources\":{\"requests\":{\"cpu\":\"50m\",\"memory\":\"64Mi\"},\"limits\":{\"cpu\":\"200m\",\"memory\":\"256Mi\"}},\"podDisruptionBudget\":{\"enabled\":true,\"maxUnavailable\":1},\"webhookNamespaceSelectors\":[]}"
        ],
        "version": "1.7.0",
        "wait": true
      },
      "external-secrets-operator": {
        "//": {
          "metadata": {
            "path": "layerx-eks-stack/external-secrets-operator",
            "uniqueId": "external-secrets-operator"
          }
        },
        "atomic": true,
        "chart": "external-secrets",
        "create_namespace": true,
        "depends_on": [
          "helm_release.aws-load-balancer-controller"
        ],
        "name": "external-secrets",
        "namespace": "external-secrets",
        "provider": "helm",
        "repository": "https://charts.external-secrets.io",
        "timeout": 300,
        "values": [
          "{\"installCRDs\":true,\"webhook\":{\"port\":9443},\"certController\":{\"enabled\":true},\"serviceAccount\":{\"create\":true,\"name\":\"external-secrets\"},\"provider\":{\"aws\":{\"enabled\":true,\"region\":\"${data.aws_region.current-region.name}\",\"service\":\"SecretsManager\"}},\"controller\":{\"leaderElect\":true,\"replicas\":1}}"
        ],
        "version": "v0.17.1-rc1"
      }
    }
  },
  "terraform": {
    "backend": {
      "local": {
        "path": "/home/opsxe/Development/layerx-home-assignment/cdktf/terraform.layerx-eks-stack.tfstate"
      }
    },
    "required_providers": {
      "aws": {
        "source": "aws",
        "version": "5.99.1"
      },
      "helm": {
        "source": "helm",
        "version": "2.17.0"
      },
      "kubernetes": {
        "source": "kubernetes",
        "version": "2.37.1"
      }
    }
  }
}